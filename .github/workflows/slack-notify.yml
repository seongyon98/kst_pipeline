name: Notify Slack on Push
on: push
jobs:
  slack_notification:
    runs-on: ubuntu-latest
    steps:
    - name: Check out repository
      uses: actions/checkout@v2
      with:
        fetch-depth: 0  # ì „ì²´ Git íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ì„¤ì •

    - name: Send Slack notification
      run: |
        COMMIT_MESSAGE=$(git log -1 --pretty=%B)
        AUTHOR_NAME=$(git log -1 --pretty=format:'%an')
        FILES_CHANGED=$(git diff-tree --no-commit-id --name-only -r HEAD)
        BRANCH_NAME=$(echo "${{ github.ref }}" | sed 's|refs/heads/||')
        FILES_COUNT=$(echo "$FILES_CHANGED" | wc -l)
        # Slack ë©”ì‹œì§€ í¬ë§·
        curl -X POST -H 'Content-type: application/json' --data "{
          \"text\":\":wave: *ìƒˆë¡œìš´ í‘¸ì‹œê°€ ë„ì°©í–ˆì–´ìš”!*\n\n:technologist: *ì‘ì„±ì:* $AUTHOR_NAME ë‹˜\n:label: *ë¸Œëœì¹˜:* \`$BRANCH_NAME\`\n:file_folder: *ë³€ê²½ëœ íŒŒì¼ ëª©ë¡ ($FILES_COUNTê°œ):*\n\`\`\`$FILES_CHANGED\`\`\`\n:speech_balloon: *ì»¤ë°‹ ë©”ì‹œì§€:*\n\`\`\`$COMMIT_MESSAGE\`\`\`\nğŸ¤– *YOLO ì„±ëŠ¥ ì§±ì§±ë§¨ ê¸°ì›*ğŸ¦¿\" 
        }" ${{ secrets.SLACK_WEBHOOK_URL }}
